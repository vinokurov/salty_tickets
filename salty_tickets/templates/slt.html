{% import "bootstrap/wtf.html" as wtf %}

{% macro render_workshop_form_field(form_field, event) %}
<div class="card card-default">
{% if form_field.product_type == 'DonateProduct' %}
  {{ donate_product(form_field) }}
{% elif form_field.product_type == 'MarketingProduct' %}
  {{ marketing_product(form_field, event) }}
{% elif form_field.product_type == 'CouplesOnlyWorkshop' %}
    {{ couples_only_workshop_product(form_field, event) }}
{% elif form_field.product_type == 'RegularPartnerWorkshop' %}
    {{ regular_partner_workshop_product(form_field, event) }}
{% else %}
   <div class="card-body">
    {%- for subfield in form_field %}
      {% if not bootstrap_is_hidden_field(subfield) and subfield != form_field.add -%}
        {{ wtf.form_field(subfield,
                      form_type=form_type,
                      horizontal_columns=horizontal_columns,
                      button_map=button_map) }}
      {%- endif %}
    {%- endfor %}
    </div>
{% endif %}

</div>
{%- endmacro %}


{% macro donate_product(form_field) %}
{#
       <div class="card-heading">
           <h4>{{ form_field.product_name }}</h4>
       </div>
#}
    <div class="card-block">
        {{ money_text_field(form_field.amount) }}
    </div>
{% endmacro %}


{% macro marketing_product(form_field, event) %}
        {% set add_enabled = True %}
    <img class="card-img-top img-fluid" src="/static/events/{{event.event_key}}/{{form_field.img_src}}" alt="Card image cap">
    <div class="card-block">
       <!--<div class="card-heading">-->
        <h4 class="card-title"><div class="badge badge-success">£{{ '{:.1f}'.format(form_field.price) }}</div></h4>
        <h6 class="card-subtitle  mb-2"><a href="#{{ '{}-info'.format(form_field.id) }}" data-toggle="collapse">{{ form_field.product_name }}</a></h6>
           <p class="card-text"><small class="text-muted">
               {% if form_field.available_quantity is defined %}
                    {% if form_field.available_quantity <= 0 %}
                        Sold out
                        {% set add_enabled = False %}
                    {% else %}
                        {% if form_field.available_quantity == 1 %} <i class="fa fa-fire text-danger" aria-hidden="true"></i> {% endif %}
                        Available: {{ form_field.available_quantity }}
                    {% endif %}
               {% endif %}
           </small></p>
       <!--</div>-->

    <!--<div class="card-block">-->
        <div class="card-text collapse" id="{{ '{}-info'.format(form_field.id) }}"><small>{{ form_field.info | safe}}</small></div>

<div  class="form-group">
    <div class="input-group">
        <div class="input-group-addon primary">ADD</div>
        {% if add_enabled %}
            {{ form_field.add(class='form-control') }}
        {% else %}
            {{ form_field.add(class='form-control', disabled=1) }}
        {% endif %}
        <div class="input-group-addon">£{{ form_field.price }}</div>
    </div>
</div>


    </div>
{% endmacro %}


{% macro toggle_btn_checkbox(field) %}
<div class="btn-group" data-toggle="buttons">
        <button class="btn btn-outline-success form-control slt-toggle">
            {{ field(checked=False) }} {{ field.label.text }}
        </button>
</div>
{% endmacro %}


{% macro email_field(field) %}
<div  class="form-group" id="{{field.id}}-form-group">
    <label class="sr-only" for="{{field.id}}">{{ field.label.text }}</label>
    <div class="input-group">
        <div class="input-group-addon">
            <i class="fa fa-envelope" aria-hidden="true"></i>
        </div>
        {{ field(class='form-control', placeholder=field.label.text) }}
    </div>
</div>
{% endmacro %}


{% macro name_field(field) %}
<div  class="form-group" id="{{field.id}}-form-group">
  <label class="sr-only" for="{{field.id}}">{{ field.label.text }}</label>
  <div class="input-group">
    <div class="input-group-addon">
        <i class="fa fa-user" aria-hidden="true"></i>
    </div>
    {{ field(class='form-control', placeholder=field.label.text) }}
</div>
</div>
{% endmacro %}


{% macro money_text_field(field) %}
<div class="form-group">
    {{ field.label(class='sr-only') }}
    <div class="input-group">
        <div class="input-group-addon"><i class="fa fa-gbp" aria-hidden="true"></i></div>
        <!--<input type="text" class="form-control" id="{{field.id}}" placeholder="{{ field.label.text }}">-->
        {{ field(placeholder=field.label.text,  class="form-control") }}
        <div class="input-group-addon">.00</div>
    </div>
</div>
{% endmacro %}


{% macro render_contributor(registration) %}
<div class="card card-default">
    <div class="card-block">
        {% if registration.crowdfunding_registration_properties.anonymous %}
        <h4>Anonymous <div class="badge badge-success">£{{ registration.total_amount_ordered }}</div></h4>
        {% else %}
        <h4>{{ registration.name }} <div class="badge badge-success">£{{ '{:.1f}'.format(registration.total_amount_ordered) }}</div></h4>
        {% endif %}
        {% if registration.comment %}
            <p class="card-text">
                {{ registration.comment }}
            </p>
        {% endif %}
    </div>
</div>
{% endmacro %}


{% macro couples_only_workshop_product(form_field, event) %}
<div class="card-block">
    <h4 class="card-title">{{ form_field.product_name }}</h4>
    <p class="card-text"><small class="text-muted">{{ form_field.info }} </small></p>
    <div class="btn-group" data-toggle="buttons">
        <button class="btn btn-outline-success form-control">
            {{ form_field.add(checked=False) }} {{ form_field.add.label.text }}
        </button>
    </div>
</div>
{% endmacro %}


{% macro regular_partner_workshop_product(form_field, event) %}
<div class="card-block">
    <h4 class="card-title">{{ form_field.product_name }}</h4>
    <p class="card-text"><small class="text-muted">{{ form_field.info }} </small></p>
    <div  class="form-group">{{ form_field.dance_role(class='form-control') }}</div>
    <div class="btn-group" data-toggle="buttons">
        <button class="btn btn-outline-success form-control">
            {{ form_field.add(checked=False) }} {{ form_field.add.label.text }}
        </button>
    </div>
</div>
{% endmacro %}